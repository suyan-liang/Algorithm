## 马拉车算法(最长回文子串)

> 参考如下搞懂
>
> [博客](https://www.cnblogs.com/grandyang/p/4475985.html)
>
> [j的计算，其他没啥](https://www.bilibili.com/video/BV1rE411x78x?from=search&seid=7140472625348932764)
>
> [图，然后情况的分类](https://www.bilibili.com/video/BV11E411j7TM?from=search&seid=7140472625348932764)

> 1. 暴力(O(n^2)):以每一个字符为中心，向两边寻找回文子串，在遍历完整个数组后，就可以找到最长的回文子串
> 2. 这里回文子串半径奇数的时候算上中心那个了
> 3. 回文子串半径(加上符号)-1=回文子串的长度(不加符号，即要求的那个)
> 4. so，求出带符号的最长回文子串半径即可得到ans

> 求p[i]-->利用前面已知的
>
> 因为是从左往右求，所以左边的一定都是求好了的
>
> 第一种情况中下面这种，由于p0已经求出，确定是回文子串，所以i和j的回文子串一定是一样的，直接用j的结果即可
>
> j=2*id-i
>
> 因为对称嘛！
>
> ![image-20200504212634709](C:\Users\liang\AppData\Roaming\Typora\typora-user-images\image-20200504212634709.png)
>
> 第一种情况的下面这种，在P里面的部分可以套用j，在P外面的暴力求解
>
> ![image-20200504212814145](C:\Users\liang\AppData\Roaming\Typora\typora-user-images\image-20200504212814145.png)
>
> 第二种情况，直接暴力求解即可
>
> ![image-20200504212853806](C:\Users\liang\AppData\Roaming\Typora\typora-user-images\image-20200504212853806.png)
>
> 

```cpp
string Manacher(string s) {
    //1.预处理，添加上$和#
    // Insert '#'
    string t = "$#";
    for (int i = 0; i < s.size(); ++i) {
        t += s[i];
        t += "#";
    }
    
    
    //求p[i]数组，分类讨论
    vector<int> p(t.size(), 0);
    /*
    mx代表回文串能延伸到的最右端的位置，需要注意的是，这个 mx 位置的字符不属于回文串
    id代表mx对应回文串的中心
    resLen代表最长回文子串的长度(带#)
    resCenter代表最长回文子串的中心(带#)
     */
    int mx = 0, id = 0, resLen = 0, resCenter = 0;
    //注意从1开始，因为第0个是$
    for (int i = 1; i < t.size(); ++i) {
        //分两种情况，先处理一下p[i]，看能不能利用原来的结果
        p[i] = mx > i ? min(p[2 * id - i], mx - i) : 1;
        //暴力求剩下的
        while (t[i + p[i]] == t[i - p[i]]) ++p[i];
        //更新mx和id以及res
        if (mx < i + p[i]) {
            mx = i + p[i];
            id = i;
        }
        if (resLen < p[i]) {
            resLen = p[i];
            resCenter = i;
        }
    }
    //返回结果
    return s.substr((resCenter - resLen) / 2, resLen - 1);
}
```

![image-20200504215835850](C:\Users\liang\AppData\Roaming\Typora\typora-user-images\image-20200504215835850.png)

![image-20200504215851845](C:\Users\liang\AppData\Roaming\Typora\typora-user-images\image-20200504215851845.png)